# 安装
## 二进制包安装mysql8.0
Centos/Rocky/Ubuntu操作都一样
1. 下载
    ```
    cd  /usr/local

    sudo curl -O https://cdn.mysql.com/Downloads/MySQL-8.0/mysql-8.0.30-linux-glibc2.12-x86_64.tar.xz
    ```
2. 解压
    ```
    sudo tar Jxf mysql-8.0.30-linux-glibc2.12-x86_64.tar.xz

    sudo ln -s mysql-8.0.30-linux-glibc2.12-x86_64 mysql
    ```
3. 创建用户
    ```
    sudo useradd -s /sbin/nologin  mysql
    ```
4. 创建数据目录
    ```
    sudo mkdir -p /data/mysql

    sudo chown -R mysql:mysql /data/mysql
    ```
    > 数据目录尽量放在大的磁盘，性能更好的磁盘里，mysql对磁盘读写要求很高
5. 定义基础配置文件
    ```
    $ sudo vim /etc/my.cnf
    # 客户端配置
    [mysql]
    port = 3306
    socket = /tmp/mysql.sock

    # 服务端配置
    [mysqld]
    user = mysql
    port = 3306
    basedir = /usr/local/mysql      # 程序存放路径
    datadir = /data/mysql           # 数据存放路径
    socket = /tmp/mysql.sock        # 本地连接socket，socket是linux进程间、程序间通信的一种方式
    pid-file = /data/mysql/mysqld.pid
    log-error = /data/mysql/mysql.err
    ```
6. 安装依赖
    ```
    # Rocky/Centos
    sudo yum install -y ncurses-compat-libs-6.1-9.20180224.el8.x86_64 libaio-devel

    # Ubuntu
    sudo  apt install  libaio-dev libtinfo5
    ```
7. 初始化数据库
    ```
    /usr/local/mysql/bin/mysqld --console --initialize-insecure --user=mysql
    ```
    > `initialize-insecure`使用空密码
8. 定义启动配置文件
    ```
    $ sudo vim /usr/lib/systemd/system/mysqld.service

    [Unit]
    Description=MYSQL server
    After=network.target
    [Install]
    WantedBy=multi-user.target
    [Service]
    Type=forking
    TimeoutSec=0
    PermissionsStartOnly=true
    ExecStart=/usr/local/mysql/bin/mysqld --defaults-file=/etc/my.cnf --daemonize $OPTIONS
    ExecReload=/bin/kill -HUP -$MAINPID
    ExecStop=/bin/kill -QUIT $MAINPID
    KillMode=process
    LimitNOFILE=65535
    Restart=on-failure
    RestartSec=10
    RestartPreventExitStatus=1
    PrivateTmp=false
    ```
9. 启动服务
    ```
    sudo systemctl daemon-reload
    sudo systemctl enable mysqld
    sudo systemctl start mysqld
    ```
10. 配置环境变量
    ```
    $ sudo vim /etc/profile.d/mysql.sh
    export PATH=$PATH:/usr/local/mysql/bin

    $ sudo source /etc/profile.d/mysql.sh
    ```
11. 设置密码
    ```
    mysqladmin -uroot  password  'your_new_passwd'
    ```
    > `your_new_passwd`更换为你的密码

